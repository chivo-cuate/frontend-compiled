(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ad779b0"],{"68b0":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{attrs:{fluid:""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md4:""}},[i("v-card",[i("v-list",{attrs:{dense:""}},e._l(e.$store.getters.getBranchPermissions,function(t,a){return i("v-list-item",{key:"action-"+a,attrs:{to:t.slug}},[i("v-list-item-action",[i("v-icon",{attrs:{color:e.$store.getters.getThemeColor}},[e._v(e._s(t.icon))])],1),i("v-list-item-content",[i("v-list-item-title",[e._v(e._s(t.name))])],1)],1)}),1)],1)],1),i("v-flex",{attrs:{xs12:"",md8:"","text-center":""}},[i("v-flex",{attrs:{md11:"","offset-md1":""}},[i("v-card",{staticClass:"elevation-0"},[i("p",{staticClass:"text-center uppercase white--text",class:e.$store.getters.getThemeColor},[e._v(e._s(e.$route.params.action))]),"inicio"===e.currAction?i("Index"):e._e(),"ingredientes"===e.currAction?i("Assets",{staticClass:"animated fadeIn",attrs:{apiUrl:e.currAction}}):e._e(),"almacen"===e.currAction?i("Stock",{staticClass:"animated fadeIn"}):e._e(),"productos"===e.currAction?i("Assets",{staticClass:"animated fadeIn",attrs:{apiUrl:e.currAction}}):e._e(),"menu-diario"===e.currAction?i("DailyMenu",{staticClass:"animated fadeIn"}):e._e()],1)],1)],1)],1)],1)},s=[],n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",[i("span",{staticClass:"title"},[e._v("Seleccione la opción deseada.")])])},r=[],o={data:()=>({})},d=o,l=i("2877"),c=i("6544"),u=i.n(c),m=i("0e8f"),g=Object(l["a"])(d,n,r,!1,null,null,null),p=g.exports;u()(g,{VFlex:m["a"]});var v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{attrs:{xs12:""}},[i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,page:e.page,"items-per-page":10,loading:e.loadingItems,"footer-props":{itemsPerPageText:"Elementos por página",itemsPerPageOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:20,text:"20"},{value:9999999999,text:"Todos"}],showFirstLastPage:!1},"item-key":"name"},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"top",fn:function(){return[i("v-toolbar",{attrs:{flat:"",color:"white"}},[i("v-toolbar-title",{staticClass:"success--text"},[e._v("ALMACEN")]),i("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),i("v-spacer"),i("v-dialog",{attrs:{"max-width":"550px",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"mb-2",attrs:{disabled:e.loadingItems||e.updatingItem,color:e.$store.getters.getThemeColor,dark:""},on:{click:function(t){return e.addItem()}}},a),[i("v-icon",{attrs:{small:""}},[e._v("add")]),e._v("Adicionar\n            ")],1)]}}]),model:{value:e.dlgUpdateItem,callback:function(t){e.dlgUpdateItem=t},expression:"dlgUpdateItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",on:{submit:function(e){e.preventDefault()}},model:{value:e.validForm,callback:function(t){e.validForm=t},expression:"validForm"}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",sm8:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.assets,"item-text":"name","item-value":"id",label:"Recurso","no-data-text":"No hay resultados"},model:{value:e.editedItem.asset_id,callback:function(t){e.$set(e.editedItem,"asset_id",t)},expression:"editedItem.asset_id"}})],1),i("v-flex",{attrs:{xs12:"",sm4:""}},[i("v-text-field",{attrs:{rules:e.requiredRules,outlined:"",label:"Cantidad"},model:{value:e.editedItem.quantity,callback:function(t){e.$set(e.editedItem,"quantity",t)},expression:"editedItem.quantity"}})],1)],1),i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",sm8:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.measureUnits,"item-value":"id","item-text":"name",label:"Unidad de medida"},model:{value:e.editedItem.measure_unit_id,callback:function(t){e.$set(e.editedItem,"measure_unit_id",t)},expression:"editedItem.measure_unit_id"}})],1),i("v-flex",{attrs:{xs12:"",sm4:""}},[i("v-text-field",{attrs:{rules:e.requiredRules,outlined:"",label:"Precio unitario"},model:{value:e.editedItem.price_in,callback:function(t){e.$set(e.editedItem,"price_in",t)},expression:"editedItem.price_in"}})],1)],1)],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:!e.validForm||e.updatingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.save()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgUpdateItem=!1}}},[e._v("Cancelar")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"300px",persistent:""},model:{value:e.dlgDeleteItem,callback:function(t){e.dlgDeleteItem=t},expression:"dlgDeleteItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Eliminar elemento")])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("p",[e._v("\n                      ¿Seguro que desea eliminar\n                      "),i("b",[e._v(e._s(e.editedItem.asset_name))]),e._v("?\n                    ")])])],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:e.deletingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.remove()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgDeleteItem=!1}}},[e._v("Cancelar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var a=t.item;return[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({staticClass:"mr-2",attrs:{color:e.$store.getters.getThemeColor},on:{click:function(t){return e.editItem(a)}}},s),[e._v("edit")])]}}],null,!0)},[i("span",[e._v("Editar")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({attrs:{color:"warning"},on:{click:function(t){return e.deleteItem(a)}}},s),[e._v("delete")])]}}],null,!0)},[i("span",[e._v("Eliminar")])])]}},{key:"loading",fn:function(){return[i("VProgress",{staticClass:"text-center"})]},proxy:!0},{key:"no-data",fn:function(){return[e._v("No se han encontrado elementos.")]},proxy:!0}])}),i("AxiosComponent",{ref:"axios",on:{finish:function(t){return e.handleHttpResponse(t)}}})],1)},h=[],I={data(){return{dlgUpdateItem:!1,dlgDeleteItem:!1,page:1,pageCount:0,loadingItems:!0,editedIndex:-1,editedItem:{},validForm:!1,requiredRules:[e=>!!e||"Dato obligatorio"],items:[],assets:[],updatingItem:!1,deletingItem:!1,headers:[{text:"Recurso",value:"asset_name",align:"left"},{text:"Cantidad",value:"quantity_desc",align:"left"},{text:"Precio ent",value:"price_in",align:"left"},{text:"Tipo",value:"type_name",align:"left"},{text:"Acciones",value:"action",align:"left",sortable:!1}],measureUnits:[]}},computed:{formTitle(){return-1===this.editedIndex?"Adicionar":"Editar"}},mounted(){this.getDataFromApi()},methods:{handleHttpResponse(e){this.loadingItems=!1;let t=e.url.substring(e.url.lastIndexOf("/")+1);if(200===e.data.result.code){var i=e.data.result.response;switch(t){case"crear":case"editar":case"eliminar":this.dlgUpdateItem=!1,this.dlgDeleteItem=!1,this.updatingItem=!1,this.deletingItem=!1,"success"===i.code&&this.setScopeObjects(i);break;case"listar":this.setScopeObjects(i);break;default:break}}else this.dlgUpdateItem=!1,this.dlgDeleteItem=!1,this.updatingItem=!1,this.deletingItem=!1},setScopeObjects(e){this.items=e.data[0],this.assets=e.data[1],this.measureUnits=e.data[2]},getDataFromApi(){this.loadingItems=!0;var e={url:"almacen/listar",params:{branch_id:this.$store.getters.getCurrBranch.id}};this.$refs.axios.submit(e)},editItem(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dlgUpdateItem=!0},addItem(){let e={id:-1,quantity:null,measure_unit_id:null,asset_id:null,price_in:null,branch_id:this.$store.getters.getCurrBranch.id};this.editedItem=Object.assign({},e),this.dlgUpdateItem=!0},deleteItem(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dlgDeleteItem=!0},remove(){if(!this.deletingItem){this.deletingItem=!0;var e={method:"post",url:"almacen/eliminar",params:{id:this.editedItem.id,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},save(){if(!this.updatingItem){this.updatingItem=!0;var e={method:"post",url:-1===this.editedItem.id?"almacen/crear":"almacen/editar",params:{item:this.editedItem,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}}}},f=I,x=i("c6a6"),b=i("8336"),_=i("b0af"),C=i("99d9"),k=i("a523"),y=i("8fea"),V=i("169a"),$=i("ce7e"),A=i("4bd4"),D=i("132d"),w=i("a722"),T=i("490a"),E=i("2fa4"),U=i("8654"),S=i("71d9"),F=i("2a7f"),O=i("3a2f"),P=Object(l["a"])(f,v,h,!1,null,null,null),q=P.exports;u()(P,{VAutocomplete:x["a"],VBtn:b["a"],VCard:_["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VContainer:k["a"],VDataTable:y["a"],VDialog:V["a"],VDivider:$["a"],VFlex:m["a"],VForm:A["a"],VIcon:D["a"],VLayout:w["a"],VProgressCircular:T["a"],VSpacer:E["a"],VTextField:U["a"],VToolbar:S["a"],VToolbarTitle:F["b"],VTooltip:O["a"]});var j=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{attrs:{xs12:""}},[i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,page:e.page,"items-per-page":10,loading:e.loadingItems,"footer-props":{itemsPerPageText:"Elementos por página",itemsPerPageOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:20,text:"20"},{value:9999999999,text:"Todos"}],showFirstLastPage:!1},"item-key":"name"},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"top",fn:function(){return[i("v-toolbar",{attrs:{flat:"",color:"white"}},[i("v-toolbar-title",{staticClass:"success--text uppercase"},[e._v(e._s(e.apiUrl))]),i("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),i("v-spacer"),i("v-dialog",{attrs:{"max-width":"500px",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"mb-2",attrs:{disabled:e.loadingItems||e.updatingItem,color:e.$store.getters.getThemeColor,dark:""},on:{click:function(t){return e.showDlgAddEdit(null)}}},a),[i("v-icon",{attrs:{small:""}},[e._v("add")]),e._v("Adicionar\n            ")],1)]}}]),model:{value:e.dlgUpdateItem,callback:function(t){e.dlgUpdateItem=t},expression:"dlgUpdateItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",on:{submit:function(e){e.preventDefault()}},model:{value:e.validForm,callback:function(t){e.validForm=t},expression:"validForm"}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{attrs:{rules:e.requiredRules,outlined:"",label:"Nombre"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1),"productos"===e.apiUrl?i("v-flex",{attrs:{xs12:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.categories,"item-text":"name","item-value":"id",label:"Categoría","no-data-text":"No hay resultados"},model:{value:e.editedItem.category_id,callback:function(t){e.$set(e.editedItem,"category_id",t)},expression:"editedItem.category_id"}})],1):e._e()],1),e.editedItem.id>0?i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-checkbox",{attrs:{label:"Activo"},model:{value:e.editedItem.status,callback:function(t){e.$set(e.editedItem,"status",t)},expression:"editedItem.status"}})],1)],1):e._e()],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:!e.validForm||e.updatingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.save()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgUpdateItem=!1}}},[e._v("Cancelar")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"300px",persistent:""},model:{value:e.dlgDeleteItem,callback:function(t){e.dlgDeleteItem=t},expression:"dlgDeleteItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Eliminar elemento")])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("p",[e._v("¿Seguro que desea eliminar el elemento "+e._s(e.editedItem.name)+"?")])])],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:e.deletingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.remove()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgDeleteItem=!1}}},[e._v("Cancelar")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"700px",persistent:""},model:{value:e.dlgIngredients,callback:function(t){e.dlgIngredients=t},expression:"dlgIngredients"}},[i("v-card",[i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-data-table",{staticClass:"elevation-1",attrs:{items:e.editedIngredients,headers:e.ingredientsHeaders,"items-per-page":5,"footer-props":{itemsPerPageText:"Elementos por página",showFirstLastPage:!1},"item-key":"index"},scopedSlots:e._u([{key:"top",fn:function(){return[i("v-toolbar",{attrs:{flat:"",color:"white"}},[i("v-toolbar-title",{staticClass:"success--text"},[e._v("Ingredientes")]),i("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),i("v-spacer"),i("v-dialog",{attrs:{"max-width":"350px",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"mb-2",attrs:{color:"success",dark:""},on:{click:function(t){return e.showDlgEditIngredient(null)}}},a),[e._v("Adicionar")])]}}]),model:{value:e.dlgEditIngredient,callback:function(t){e.dlgEditIngredient=t},expression:"dlgEditIngredient"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s((e.editedIngredientIndex>=0?"Editar":"Adicionar")+" ingrediente"))])]),i("v-card-text",[i("v-container",[i("v-form",{ref:"ingredientForm",on:{submit:function(e){e.preventDefault()}},model:{value:e.validIngredientForm,callback:function(t){e.validIngredientForm=t},expression:"validIngredientForm"}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.ingredients,"item-value":"id","item-text":"name",label:"Ingrediente","no-data-text":"No hay resultados"},model:{value:e.editedIngredient.component_id,callback:function(t){e.$set(e.editedIngredient,"component_id",t)},expression:"editedIngredient.component_id"}})],1)],1),i("v-layout",[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("v-text-field",{attrs:{outlined:"",rules:e.numberRules,label:"Cantidad",type:"number"},model:{value:e.editedIngredient.quantity,callback:function(t){e.$set(e.editedIngredient,"quantity",t)},expression:"editedIngredient.quantity"}})],1),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.measureUnits,"item-value":"id","item-text":"name",label:"U/M","no-data-text":"No hay resultados"},model:{value:e.editedIngredient.measure_unit_id,callback:function(t){e.$set(e.editedIngredient,"measure_unit_id",t)},expression:"editedIngredient.measure_unit_id"}})],1)],1)],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{disabled:!e.validIngredientForm,color:"green darken-1",text:""},on:{click:function(t){return e.saveIngredient()}}},[e._v("Aceptar")]),i("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){e.dlgEditIngredient=!1}}},[e._v("Cancelar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var a=t.item;return[i("v-icon",{staticClass:"mr-2",attrs:{color:e.$store.getters.getThemeColor},on:{click:function(t){return e.showDlgEditIngredient(a)}}},[e._v("edit")]),i("v-icon",{attrs:{color:"warning"},on:{click:function(t){return e.removeIngredient(a)}}},[e._v("delete")])]}},{key:"no-data",fn:function(){return[i("v-card-text",{staticClass:"text-center"},[e._v("No hay elementos para mostrar")])]},proxy:!0}])})],1)],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:e.updatingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.updateIngredients()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgIngredients=!1}}},[e._v("Cancelar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var a=t.item;return[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({staticClass:"mr-2",attrs:{color:e.$store.getters.getThemeColor},on:{click:function(t){return e.showDlgAddEdit(a)}}},s),[e._v("edit")])]}}],null,!0)},[i("span",[e._v("Editar")])]),"productos"===e.apiUrl?i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({attrs:{color:"info"},on:{click:function(t){return e.showDlgIngredients(a)}}},s),[e._v("local_library")])]}}],null,!0)},[i("span",[e._v("Ingredientes")])]):e._e(),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({attrs:{color:"warning"},on:{click:function(t){return e.showDlgDelete(a)}}},s),[e._v("delete")])]}}],null,!0)},[i("span",[e._v("Eliminar")])])]}},{key:"loading",fn:function(){return[i("VProgress",{staticClass:"text-center"})]},proxy:!0},{key:"no-data",fn:function(){return[e._v("No se han encontrado elementos.")]},proxy:!0}])}),i("AxiosComponent",{ref:"axios",on:{finish:function(t){return e.handleHttpResponse(t)}}})],1)},B=[],R={data(){return{validIngredientForm:!1,dlgUpdateItem:!1,dlgDeleteItem:!1,dlgIngredients:!1,dlgEditIngredient:!1,page:1,pageCount:0,loadingItems:!0,editedIndex:-1,editedItem:{},editedIngredients:[],editedIngredientIndex:-1,editedIngredient:{},validForm:!1,requiredRules:[e=>!!e||"Dato obligatorio"],numberRules:[e=>!!e||"Dato obligatorio",e=>e>0||"Dato incorrecto"],items:[],ingredients:[],categories:[],measureUnits:[],updatingItem:!1,deletingItem:!1,headers:[{text:"Nombre",value:"name",align:"left"},{text:"Estado",value:"status_name",align:"left"},{text:"Categoría",value:"category_name",align:"left"},{text:"Acciones",value:"action",align:"left",sortable:!1}],ingredientsHeaders:[{text:"Ingrediente",value:"name",align:"left"},{text:"Cantidad",value:"quantity",align:"left"},{text:"Medida",value:"measure_unit_name",align:"left"},{text:"Acciones",value:"action",align:"left",sortable:!1}]}},props:["apiUrl"],computed:{formTitle(){return-1===this.editedIndex?"Adicionar":"Editar"}},mounted(){this.getDataFromApi()},watch:{$route(e,t){this.getDataFromApi()}},methods:{handleHttpResponse(e){this.loadingItems=!1;let t=e.url.substring(e.url.lastIndexOf("/")+1);if(200===e.data.result.code){var i=e.data.result.response;switch(t){case"crear":case"editar":case"eliminar":this.dlgUpdateItem=!1,this.dlgDeleteItem=!1,this.updatingItem=!1,this.deletingItem=!1,"success"===i.code&&this.updateScopeObjects(i);break;case"listar":this.updateScopeObjects(i);break;case"editar-ingredientes":this.dlgIngredients=!1,this.updatingItem=!1,"success"===i.code&&this.updateScopeObjects(i);break;default:break}}else this.dlgUpdateItem=!1,this.dlgDeleteItem=!1,this.updatingItem=!1,this.deletingItem=!1},updateScopeObjects(e){this.items=e.data[0],this.ingredients=e.data[1],this.measureUnits=e.data[2],this.categories=e.data[3]},getDataFromApi(){this.loadingItems=!0,this.items=[];var e={url:`${this.apiUrl}/listar`,params:{branch_id:this.$store.getters.getCurrBranch.id}};this.$refs.axios.submit(e)},showDlgIngredients(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.editedIngredients=this.editedItem.components.slice(),this.dlgIngredients=!0},showDlgAddEdit(e){e?(this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e)):(this.editedIndex=-1,this.editedItem=Object.assign({},{id:-1,name:null,branch_id:this.$store.getters.getCurrBranch.id})),this.dlgUpdateItem=!0},showDlgDelete(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dlgDeleteItem=!0},remove(){if(!this.deletingItem){this.deletingItem=!0;var e={method:"post",url:`${this.apiUrl}/eliminar`,params:{id:this.editedItem.id,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},save(){if(!this.updatingItem){this.updatingItem=!0;var e={method:"post",url:-1===this.editedItem.id?`${this.apiUrl}/crear`:`${this.apiUrl}/editar`,params:{item:this.editedItem,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},updateIngredients(){if(!this.updatingItem){this.updatingItem=!0;var e={method:"post",url:`${this.apiUrl}/editar-ingredientes`,params:{id:this.editedItem.id,ingredients:this.editedIngredients,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},showDlgEditIngredient(e){e?(this.editedIngredientIndex=this.editedIngredients.indexOf(e),this.editedIngredient=Object.assign({},e)):(this.editedIngredientIndex=-1,this.editedIngredient={measure_unit_name:null,name:null}),this.dlgEditIngredient=!0},removeIngredient(e){this.editedIngredientIndex=this.editedIngredients.indexOf(e),this.editedIngredients.splice(this.editedIngredientIndex,1)},getMeasureUnitById(e){return this.measureUnits.find(t=>t.id===e)},getIngredientById(e){return this.ingredients.find(t=>t.id===e)},removeDuplicateIngredients(){let e=[];for(let t=0;t<this.editedIngredients.length;t++){let i=e.findIndex(e=>e.component_id===this.editedIngredients[t].component_id&&e.measure_unit_id===this.editedIngredients[t].measure_unit_id);i>=0?e[i].quantity=parseInt(e[i].quantity)+parseInt(this.editedIngredients[t].quantity):e.push(this.editedIngredients[t])}this.editedIngredients=e},saveIngredient(){this.editedIngredient.name=this.getIngredientById(this.editedIngredient.component_id).name,this.editedIngredient.measure_unit_name=this.getMeasureUnitById(this.editedIngredient.measure_unit_id).name,this.editedIngredientIndex>-1?(this.editedIngredients[this.editedIngredientIndex].component_id=this.editedIngredient.component_id,this.editedIngredients[this.editedIngredientIndex].name=this.editedIngredient.name,this.editedIngredients[this.editedIngredientIndex].measure_unit_id=this.editedIngredient.measure_unit_id,this.editedIngredients[this.editedIngredientIndex].measure_unit_name=this.editedIngredient.measure_unit_name,this.editedIngredients[this.editedIngredientIndex].quantity=this.editedIngredient.quantity):this.editedIngredients.push(this.editedIngredient),this.removeDuplicateIngredients(),this.dlgEditIngredient=!1}}},L=R,N=(i("6ca7"),i("ec29"),i("9d26")),H=i("c37a"),M=i("5607"),z=i("2b0e"),G=z["default"].extend({name:"rippleable",directives:{ripple:M["a"]},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple(e={}){return this.ripple?(e.staticClass="v-input--selection-controls__ripple",e.directives=e.directives||[],e.directives.push({name:"ripple",value:{center:!0}}),e.on=Object.assign({click:this.onChange},this.$listeners),this.$createElement("div",e)):null},onChange(){}}}),J=i("8547"),K=i("58df"),Q=Object(K["a"])(H["a"],G,J["a"]).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"accent"},isMultiple(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive(){const e=this.value,t=this.internalValue;return this.isMultiple?!!Array.isArray(t)&&t.some(t=>this.valueComparator(t,e)):void 0===this.trueValue||void 0===this.falseValue?e?this.valueComparator(e,t):Boolean(t):this.valueComparator(t,this.trueValue)},isDirty(){return this.isActive}},watch:{inputValue(e){this.lazyValue=e,this.hasColor=e}},methods:{genLabel(){const e=H["a"].options.methods.genLabel.call(this);return e?(e.data.on={click:e=>{e.preventDefault(),this.onChange()}},e):e},genInput(e,t){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:e,type:e},t),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown},ref:"input"})},onBlur(){this.isFocused=!1},onChange(){if(this.isDisabled)return;const e=this.value;let t=this.internalValue;if(this.isMultiple){Array.isArray(t)||(t=[]);const i=t.length;t=t.filter(t=>!this.valueComparator(t,e)),t.length===i&&t.push(e)}else t=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(t,this.trueValue)?this.falseValue:this.trueValue:e?this.valueComparator(t,e)?null:e:!t;this.validate(!0,t),this.internalValue=t,this.hasColor=t},onFocus(){this.isFocused=!0},onKeydown(e){}}}),W=Q.extend({name:"v-checkbox",props:{indeterminate:Boolean,indeterminateIcon:{type:String,default:"$vuetify.icons.checkboxIndeterminate"},onIcon:{type:String,default:"$vuetify.icons.checkboxOn"},offIcon:{type:String,default:"$vuetify.icons.checkboxOff"}},data(){return{inputIndeterminate:this.indeterminate}},computed:{classes(){return{...H["a"].options.computed.classes.call(this),"v-input--selection-controls":!0,"v-input--checkbox":!0,"v-input--indeterminate":this.inputIndeterminate}},computedIcon(){return this.inputIndeterminate?this.indeterminateIcon:this.isActive?this.onIcon:this.offIcon},validationState(){if(!this.disabled||this.inputIndeterminate)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":this.hasColor?this.computedColor:void 0}},watch:{indeterminate(e){this.inputIndeterminate=e},inputIndeterminate(e){this.$emit("update:indeterminate",e)},isActive(){this.indeterminate&&(this.inputIndeterminate=!1)}},methods:{genCheckbox(){return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.genInput("checkbox",{...this.$attrs,"aria-checked":this.inputIndeterminate?"mixed":this.isActive.toString()}),this.genRipple(this.setTextColor(this.validationState)),this.$createElement(N["a"],this.setTextColor(this.validationState,{props:{dark:this.dark,light:this.light}}),this.computedIcon)])},genDefaultSlot(){return[this.genCheckbox(),this.genLabel()]}}}),X=Object(l["a"])(L,j,B,!1,null,null,null),Y=X.exports;u()(X,{VAutocomplete:x["a"],VBtn:b["a"],VCard:_["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VCheckbox:W,VContainer:k["a"],VDataTable:y["a"],VDialog:V["a"],VDivider:$["a"],VFlex:m["a"],VForm:A["a"],VIcon:D["a"],VLayout:w["a"],VProgressCircular:T["a"],VSpacer:E["a"],VTextField:U["a"],VToolbar:S["a"],VToolbarTitle:F["b"],VTooltip:O["a"]});var Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{attrs:{xs12:""}},[i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,page:e.page,"items-per-page":10,loading:e.loadingItems,"footer-props":{itemsPerPageText:"Elementos por página",itemsPerPageOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:20,text:"20"},{value:9999999999,text:"Todos"}],showFirstLastPage:!1},"item-key":"name"},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"top",fn:function(){return[i("v-toolbar",{attrs:{flat:"",color:"white"}},[i("v-toolbar-title",{staticClass:"success--text"},[e._v(e._s(e.menuDate))]),i("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),i("v-spacer"),i("v-dialog",{attrs:{"max-width":"400px",persistent:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[i("v-btn",e._g({staticClass:"mb-2",attrs:{disabled:e.loadingItems||e.updatingItem,color:e.$store.getters.getThemeColor,dark:""},on:{click:function(t){return e.addItem()}}},a),[i("v-icon",{attrs:{small:""}},[e._v("add")]),e._v("Adicionar producto\n            ")],1)]}}]),model:{value:e.dlgUpdateItem,callback:function(t){e.dlgUpdateItem=t},expression:"dlgUpdateItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-form",{ref:"form",on:{submit:function(e){e.preventDefault()}},model:{value:e.validForm,callback:function(t){e.validForm=t},expression:"validForm"}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-autocomplete",{attrs:{outlined:"",rules:e.requiredRules,items:e.assets,"item-text":"name","item-value":"id",label:"Producto","no-data-text":"No hay resultados"},scopedSlots:e._u([{key:"item",fn:function(t){return[i("v-list-item-content",[i("v-list-item-title",{domProps:{innerHTML:e._s(t.item.name)}}),i("v-list-item-subtitle",{domProps:{innerHTML:e._s("Precio de entrada (u): $"+t.item.price_in)}})],1)]}}]),model:{value:e.editedItem.asset_id,callback:function(t){e.$set(e.editedItem,"asset_id",t)},expression:"editedItem.asset_id"}})],1)],1),i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",md6:""}},[i("v-text-field",{attrs:{rules:e.requiredRules,outlined:"",label:"Precio",hint:e.priceHint,"persistent-hint":""},model:{value:e.editedItem.price,callback:function(t){e.$set(e.editedItem,"price",t)},expression:"editedItem.price"}})],1),i("v-flex",{attrs:{xs12:"",md6:""}},[i("v-text-field",{attrs:{outlined:"",label:"Gramos"},model:{value:e.editedItem.grams,callback:function(t){e.$set(e.editedItem,"grams",t)},expression:"editedItem.grams"}})],1)],1)],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:!e.validForm||e.updatingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.save()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgUpdateItem=!1}}},[e._v("Cancelar")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"300px",persistent:""},model:{value:e.dlgDeleteItem,callback:function(t){e.dlgDeleteItem=t},expression:"dlgDeleteItem"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Eliminar elemento")])]),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("p",[e._v("\n                      ¿Seguro que desea eliminar\n                      "),i("b",[e._v(e._s(e.editedItem.asset_name))]),e._v("?\n                    ")])])],1)],1)],1),i("v-card-actions",{staticClass:"mr-5"},[i("v-spacer"),i("v-btn",{attrs:{disabled:e.deletingItem,color:e.$store.getters.getThemeColor,text:""},on:{click:function(t){return e.remove()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),i("span",[e._v("Aceptar")])],1),i("v-btn",{attrs:{color:"error",text:""},on:{click:function(t){e.dlgDeleteItem=!1}}},[e._v("Cancelar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var a=t.item;return[i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({staticClass:"mr-2",attrs:{color:e.$store.getters.getThemeColor},on:{click:function(t){return e.editItem(a)}}},s),[e._v("edit")])]}}],null,!0)},[i("span",[e._v("Editar")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[i("v-icon",e._g({attrs:{color:"warning"},on:{click:function(t){return e.deleteItem(a)}}},s),[e._v("delete")])]}}],null,!0)},[i("span",[e._v("Eliminar")])])]}},{key:"loading",fn:function(){return[i("VProgress",{staticClass:"text-center"})]},proxy:!0},{key:"no-data",fn:function(){return[e._v("No se han encontrado elementos.")]},proxy:!0}])}),e.canEnableCooks?i("v-card",{staticClass:"mt-3"},[i("v-container",[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",lg6:"","offset-lg2":""}},[i("v-autocomplete",{attrs:{chips:"",outlined:"",multiple:"",rules:e.requiredRules,items:e.allCooks,"item-text":"full_name","item-value":"id",label:"Elaboradores para este menú","no-data-text":"No hay resultados"},model:{value:e.menuCooks,callback:function(t){e.menuCooks=t},expression:"menuCooks"}})],1),i("v-flex",{attrs:{xs12:"",lg4:""}},[i("v-btn",{class:e.$store.getters.getThemeColor+" white--text",attrs:{disabled:e.menuCooks.length<1||e.updatingItem,"x-large":""},on:{click:function(t){return e.saveActiveCooks()}}},[e.updatingItem?i("v-progress-circular",{staticClass:"v-icon",attrs:{size:15,width:1,indeterminate:"",color:e.$store.getters.getThemeColor}}):i("v-icon",{attrs:{small:""}},[e._v("check")]),e._v("Actualizar\n          ")],1)],1)],1)],1)],1):e._e(),i("AxiosComponent",{ref:"axios",on:{finish:function(t){return e.handleHttpResponse(t)}}})],1)},ee=[],te={data(){return{dlgUpdateItem:!1,dlgDeleteItem:!1,page:1,pageCount:0,loadingItems:!0,editedIndex:-1,editedItem:{},validForm:!1,requiredRules:[e=>!!e||"Dato obligatorio"],items:[],assets:[],updatingItem:!1,deletingItem:!1,headers:[{text:"Producto",value:"asset_name",align:"left"},{text:"Precio",value:"price",align:"left"},{text:"Gramos",value:"grams",align:"left"},{text:"Acciones",value:"action",align:"left",sortable:!1}],measureUnits:[],menuCooks:[],allCooks:[],canEnableCooks:!1}},computed:{formTitle(){return-1===this.editedIndex?"Adicionar":"Editar"},priceIn(){if(this.editedItem.asset_id){let e=null;return this.assets.forEach(t=>{t.id===this.editedItem.asset_id&&(e=t.price_in)}),e}},priceHint(){if(this.priceIn){let e=this.editedItem.price-this.priceIn;return(e>0?"Ganacia: ":"Pérdida: ")+e}return"Seleccione un producto"},menuDate(){return this.items.length>0?this.items[0].date:"No hay productos"}},mounted(){this.$store.getters.getBranchPermissions.forEach(e=>{"Menú diario"===e.name&&e.perms.forEach(e=>{"Habilitar elaboradores"===e.text&&(this.canEnableCooks=!0)})}),this.getDataFromApi()},methods:{handleHttpResponse(e){this.loadingItems=!1,this.dlgUpdateItem=!1,this.dlgDeleteItem=!1,this.updatingItem=!1,this.deletingItem=!1,this.setScopeObjects(e)},setScopeObjects(e){if(200===e.data.result.code){var t=e.data.result.response;this.items=t.data[0],this.assets=t.data[1],this.menuCooks=t.data[2],this.allCooks=t.data[3]}},getDataFromApi(){this.loadingItems=!0;var e={url:"menu-diario/listar",params:{branch_id:this.$store.getters.getCurrBranch.id}};this.$refs.axios.submit(e)},editItem(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dlgUpdateItem=!0},addItem(){let e={id:-1,asset_id:null,price:null,grams:null};this.editedItem=Object.assign({},e),this.dlgUpdateItem=!0},deleteItem(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dlgDeleteItem=!0},remove(){if(!this.deletingItem){this.deletingItem=!0;var e={method:"post",url:"menu-diario/eliminar",params:{id:this.editedItem.id,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},save(){if(!this.updatingItem){this.updatingItem=!0;var e={method:"post",url:-1===this.editedItem.id?"menu-diario/crear":"menu-diario/editar",params:{item:this.editedItem,cooks:this.menuCooks,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}},saveActiveCooks(){if(!this.updatingItem){this.updatingItem=!0;var e={method:"post",url:"menu-diario/habilitar-elaboradores",params:{cooks:this.menuCooks,branch_id:this.$store.getters.getCurrBranch.id},snackbar:!0};this.$refs.axios.submit(e)}}}},ie=te,ae=i("5d23"),se=Object(l["a"])(ie,Z,ee,!1,null,null,null),ne=se.exports;u()(se,{VAutocomplete:x["a"],VBtn:b["a"],VCard:_["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VContainer:k["a"],VDataTable:y["a"],VDialog:V["a"],VDivider:$["a"],VFlex:m["a"],VForm:A["a"],VIcon:D["a"],VLayout:w["a"],VListItemContent:ae["a"],VListItemSubtitle:ae["b"],VListItemTitle:ae["c"],VProgressCircular:T["a"],VSpacer:E["a"],VTextField:U["a"],VToolbar:S["a"],VToolbarTitle:F["b"],VTooltip:O["a"]});var re={data:()=>({drawer:null,currAction:null}),components:{Index:p,Stock:q,DailyMenu:ne,Assets:Y},beforeRouteUpdate(e,t,i){this.verifyAction(e.params.action),i()},mounted(){this.verifyAction(this.$route.params.action)},methods:{verifyAction(e){if(this.currAction=e,"inicio"!==e){let t=!1;this.$store.getters.getBranchPermissions.forEach(i=>{let a=i.slug.substring(i.slug.lastIndexOf("/")+1);a===e&&(t=!0)}),t||this.$router.push("/not-found")}}}},oe=re,de=i("8860"),le=i("da13"),ce=i("1800"),ue=Object(l["a"])(oe,a,s,!1,null,null,null);t["default"]=ue.exports;u()(ue,{VCard:_["a"],VContainer:k["a"],VFlex:m["a"],VIcon:D["a"],VLayout:w["a"],VList:de["a"],VListItem:le["a"],VListItemAction:ce["a"],VListItemContent:ae["a"],VListItemTitle:ae["c"]})},"6ca7":function(e,t,i){},ec29:function(e,t,i){}}]);
//# sourceMappingURL=chunk-9ad779b0.b547fcfe.js.map